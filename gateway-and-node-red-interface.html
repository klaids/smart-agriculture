<!DOCTYPE HTML>
<!--
	Arcana by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Gateway and Node-Red Interface</title>
		<link rel="shortcut icon" href="images/favicon.ico">
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
        <style type="text/css">
            .justify {
                text-align: justify;
                text-justify: inter-word;
            }
        </style>
	</head>
	<body class="is-preload">
		<div id="page-wrapper">

			<!-- Header -->
				<div id="header">

					<!-- Logo -->
						<h1>Smart Agriculture <em>a sensors network with LoRa</em></a></h1>

					<!-- Nav -->
						<nav id="nav">
							<ul>
								<li><a href="index.html">Home</a></li>
								<li><a href="lora-technology.html">LoRa Technology</a></li>
								<li class="current">
									<a href="#">Project</a>
									<ul>
										<li><a href="field-modules.html">Field Modules</a></li>
										<li><a href="gateway-and-node-red-interface.html">Gateway and Node-Red Interface</a></li>
										<li><a href="sensors.html">Sensors</a></li>
										<li><a href="regarding-security.html">Regarding Security</a></li>
									</ul>
								</li>
								<li><a href="future-development.html">Future Developments</a></li>
								<li><a href="#footer">Contacts</a></li>
							</ul>
						</nav>

				</div>

			<!-- Main -->
				<section class="wrapper style1">
					<div class="container">
						<!-- <div class="row gtr-200"> -->
							<!-- <div class="col-4 col-12-narrower"> -->
								<!-- <div id="sidebar"> -->

									<!-- left Sidebar -->
									<!-- <section> -->
											<!-- <h3>Reference to used Node-RED flows</h3> -->
											<!-- <ul class="links"> -->
												<!-- <li><a href="https://flows.nodered.org/node/node-red-contrib-lorawan-packet-decrypt-nwkey-appkey">LoRaWAN Packet Decryptor</a></li> -->
												<!-- <li><a href="https://flows.nodered.org/flow/44bc7ad491aacb4253dd8a5f757b5407">File Browser in Dashboard</a></li> -->
												<!-- <li><a href="https://flows.nodered.org/flow/fa6e4749ff7f9067fd6b5330bc54f9e3">Raspberry System Monitoring</a></li> -->
											<!-- </ul> -->
									<!-- </section> -->
								<!-- </div> -->
							<!-- </div> -->

							<!-- Content -->
								<div id="content" class="justify">
									<article>
										<header>
											<h2>Node-RED Dashboard Presentation</h2>
											<p>A platform to manage easily your end devices and monitoring your system.</p>
										</header>
										<!-- Header image -->
										<section>
											<center>
											<span class="image responsive"><img src="images/Node-RED/node1.jpeg" alt="" /></span>
											<p style="text-align:center;">immagine di test, ne metterò una reale</p>
											</center>
										</section>
										<!-- Intro -->
										<section>
										<h3>Introduction</h3>
												<p>
												In this part we will discuss these topics:
													<li><a href="#raspberry">Description about our Gateway and its shield to receive the data</a></li>
													<li><a href="#node-red-introduction">Node-RED Introduction</a></li>
													<li><a href="#node-red-control-panel">Node-RED Control Panel</a></li>
													<li><a href="#dashboard-presentation">Smart-Agriculture Dashboard Presentation</a></li>
												</p>
											<p>
												From this link you can download the libraries installation guide (.pdf), 
												<a href="https://github.com/lorenzozaccomer/smart-agriculture/blob/main/Documentation/Library%20Manuals%20for%20RPi.pdf">here</a>.<br>
												Also, if you did not fully understand some parts of this paragraph or you want to learn more, you can watch this video:
											</p>
										</section>
										<!-- Youtube Video -->
										<section>
											<center>
												<div class="auto-resizable-iframe">
												  <div>
													<iframe frameborder="0" allowfullscreen="" src="https://www.youtube.com/embed/v=GgaPLm49r0Q?version=3&loop=1&playlist=GgaPLm49r0Q"></iframe>
												  </div>
												</div> 
											</center>
										</section>
										
										<!--Raspberry-->
										<section id="raspberry">
										<h3>Description about our Gateway and its shield to receive the data</h3>
										<h4>Gateway</h4>
										<p>
											To receive the information’s from the device node we used a Raspberry Pi 3B+ (RPi3), 
											because is so smart for many applications, low power consumption, 
											you can interface on it in several ways, 
											configurable as you can want and 40 GPIO PIN to put the shield that you want, 
											and but not less important, is very small, 
											and is usable also for the users that are not practical with CLI commands. 
										<!-- RPi3 figure -->
										<center>
											<span class="image responsive"><img src="images/Node-RED/rpi3.png" alt="" /></span>
											<p style="text-align:center;">Raspberry Pi 3B+</p>
										</center>
										
										<h4>Shield for LoraWAN Application</h4>
										Our choice about the shield for the RPi3 is fell on IoT LoraNode pHAT 
										<a href="https://uk.pi-supply.com/products/iot-lora-node-phat-for-raspberry-pi">IoT LoRa Node pHAT for Raspberry Pi (Multi Frequency),</a> 
										that used a RAK811 LoRa Module
										<a href="https://uk.pi-supply.com/products/rak811-lora-lorawan-module">RAK811 LoRa / LoRAWAN module (based on SX1276) 868/915MHz up to 3km range,</a>											
										based on SX1276, because can manage a very high number of nodes, 
										has low consumption (50mA in transmission) and high range coverage (up to 3km).
										</p>
										<!-- pHAT figure 1 & 2 -->
										<div class="row">
										  <div class="col-6">
											<center>
											<span class="image responsive"><img src="images/Node-RED/phat-2.png" alt="" /></span>
											</center>
										  </div>
										  <div class="col-6">
											<center>
											<span class="image responsive"><img src="images/Node-RED/lora-node.png" alt="" /></span>
											</center>
										  </div>
										</div>
										<p style="text-align:center;">pHAT</p>
										
										<p>
										By default, this shield is not thought to use as gateway, 
										the basic configuration is to send the data, but our goal for this project is to reduce the costs, 
										and the gateway shield has a significant cost, so we configured the pHAT module as gateway.
										It has 2 antennas, one internal, used by default, and one external to improve the range of the transmission.
										In our beta test for the firsts data transmission, we used the internal antenna because is smart, 
										but in the end of final tests, we used the external antenna for improve the data range, 
										to use it we de-solder the inductor from on the INT solder pads and put it on the EXT solder pads.
										</p>
										<!-- pHAT figure 3 -->
										<center>
											<span class="image responsive"><img src="images/Node-RED/phat-3.png" alt="" /></span>
											<p style="text-align:center;">pHAT INT/EXT Solder pads</p>
										</center>
										
										<p>
										From the
										<a href="https://uk.pi-supply.com/products/iot-lora-node-phat-for-raspberry-pi">Official Pi-Supply repository</a> 											
										on GitHub you can find additional informations and software.
										</p>
										</section>
										
										<!--NODE-RED Introduction-->
										<section id="node-red-introduction">
										<h3>Node-RED Introduction</h3>
										<p>What’s Node-RED?<br>
											Node-RED, based on JavaScript, is a graphical object programming platform to perform different type of projects.<br>
											One of the major features is to programming using the nodes, 
											link to each other to obtain the result, 
											and every node can contain a little script or information to manipulate the input message, 
											this feature allows to the people who are unfamiliar with coding, to create their own project very quickly.<br>
											Another feature of Node-RED it can be installed in different type of devices, for example on Raspberry Pi, your PC, etc.<br>
											Also, you can secure it using a password, to do that you need to modify settings.js (hidden) file, for more details:
											<a href="https://nodered.org/docs/user-guide/runtime/securing-node-red">Securing Node-RED</a>.<br>
											For more details about Node-RED watch on the 
											<a href="https://nodered.org/">Node-RED official website</a> or watch on our Regarding Security tab.
										</p>
										</section>

										<!-- Node-RED Control Panel -->
										<section id="node-red-control-panel">
										<h3>Node-RED Control Panel</h3>
										<p>
											In this part we describe from the Node-RED Control Panel 
											the main flow, 
											where the script will launch and data’s management, so let’s start.
										</p>
										
										<!-- How it works -->
										<h4>How it works</h4>
										<p>
											At Start&Stop (Figure 1) nodes group you can manually start (Message Reception) or stop the script (Stop Searching New Message), 
											or you can use the button on the Home Tab.<br>
											The connection with the next group is done with the link highlighted in red.
										</p>
										<!-- Figure 1 
										<center>
											<span class="image responsive"><img src="images/Node-RED/immagine1.png" alt="" /></span>
											<p style="text-align:center;">Figure 1</p>
										</center>
										-->	
											
										<div class="slideshow-container">
										  <!-- Full-width images with number and caption text -->
										  <div class="mySlides fade">
											<div class="numbertext">1 / 7</div>
											<!-- 
											<center>
											<img src="images/Node-RED/immagine1.png" style="width:50%">
											</center>
											-->
											<span class="image responsive"><img src="images/Node-RED/immagine1.png" alt="" /></span>
											
											<div class="text">Figure 1</div>
										  </div>

										  <div class="mySlides fade">
											<div class="numbertext">2 / 7</div>
											<center>
											<img src="images/Node-RED/immagine2.png" style="width:50%">
											</center>
											<div class="text">Figure 2</div>
										  </div>

										  <div class="mySlides fade">
											<div class="numbertext">3 / 7</div>
											<center>
											<img src="images/Node-RED/immagine3.png" style="width:50%">
											</center>
											<div class="text">Figure 3</div>
										  </div>
											
										  <div class="mySlides fade">
											<div class="numbertext">4 / 7</div>
											<center>
											<img src="images/Node-RED/immagine4.png" style="width:50%">
											</center>
											<div class="text">Figure 4</div>
										  </div>
											
										  <div class="mySlides fade">
											<div class="numbertext">5 / 7</div>
											<center>
											<img src="images/Node-RED/immagine5.png" style="width:50%">
											</center>
											<div class="text">Figure 5</div>
										  </div>
											
										  <div class="mySlides fade">
											<div class="numbertext">6 / 7</div>
											<center>
											<img src="images/Node-RED/immagine6.png" style="width:50%">
											</center>
											<div class="text">Figure 6</div>
										  </div>
											
										  <div class="mySlides fade">
											<div class="numbertext">7 / 7</div>
											<center>
											<img src="images/Node-RED/immagine7.png" style="width:50%">
											</center>
											<div class="text">Figure 7</div>
										  </div>

										  <!-- Next and previous buttons -->
										  <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
										  <a class="next" onclick="plusSlides(1)">&#10095;</a>
										</div>
										<br>

										<!-- The dots/circles -->
										<div style="text-align:center">
										  <span class="dot" onclick="currentSlide(1)"></span>
										  <span class="dot" onclick="currentSlide(2)"></span>
										  <span class="dot" onclick="currentSlide(3)"></span>
										  <span class="dot" onclick="currentSlide(4)"></span>
										  <span class="dot" onclick="currentSlide(5)"></span>
										  <span class="dot" onclick="currentSlide(6)"></span>
										  <span class="dot" onclick="currentSlide(7)"></span>
										</div>
										
										<p>
											In the following group arrives the input on LoraPi Receive Script node and it launch 
											(break) the .py script with the command previously set and return that the gateway will 
											receives from the LoRa Nodes, as you can see in the next screens.
										</p>
										<!-- Figure 2 
										<center>
											<span class="image responsive"><img src="images/Node-RED/Immagine2.png" alt="" /></span>
											<p style="text-align:center;">Figure 2</p>
										</center> -->
										<!-- Figure 3 -->
										<center>
										<span class="image responsive"><img src="images/Node-RED/Immagine3.png" alt="" /></span>
										<p style="text-align:center;">Figure 3</p>
										</center>
										<p>
											About the Extrapolation group, we will focus on Extract Information from payload and DevAddr subgroups.<br>
											A focus is on Decrypt LoraWAN, where you need to put your personal Network Secret Key and Application Secret Key.<br>
											On the first one, we have all the conversion and manipulation part of the payload that our gateway receives.<br>
											The Sensor data hex/string decode will return the original message with $ separator, 
											and the last node create a dictionary with all the values, and example is at Figure 5, 
											where the values are generated from our test board.
										</p>
										<!-- Figure 4 -->
										<center>
										<span class="image responsive"><img src="images/Node-RED/Immagine4.png" alt="" /></span>
										<p style="text-align:center;">Figure 4</p>
										</center>
										<!-- Figure 5 -->
										<center>
										<span class="image responsive"><img src="images/Node-RED/Immagine5.png" alt="" /></span>
										<p style="text-align:center;">Figure 5</p>
										</center>
										<p>
											At this point, we have obtained the original message, and the DevAddr (Figure 6), 
											but is not in string format as we need, so to convert it we used the second one subgroup, 
											and it done other secondaries activities, 
											for example you can add additional information to better identify the board on the Dashboard.
										</p>
										<!-- Figure 6 -->
										<center>
										<span class="image responsive"><img src="images/Node-RED/Immagine6.png" alt="" /></span>
										<p style="text-align:center;">Figure 6</p>
										</center>
										<p>
											At the end of all of this, there’s the last fundamental group (Devices) 
											that from the DevAddr identify redirect to the proper flow, as you can see in this Figure.
										</p>
										<!-- Figure 7 -->
										<center>
										<span class="image responsive"><img src="images/Node-RED/Immagine7.png" alt="" /></span>
										<p style="text-align:center;">Figure 7</p>
										</center>
										</section>
									
										<!-- How Smart-Agriculture Dashboard works -->
										<section id="dashboard-presentation">
										<h3>Smart-Agriculture Dashboard Presentation</h3>
										<p>
											Here we describe the GUI of our Dashboard.
										</p>
										
										<!-- Home -->
										<h4>Home</h4>
										<p>
											Here you can visualize all the main information from your module,
											as the DevAddr, and the data that it transmit, and also you can manage
											the script with two buttons and visualize the situation of it.
											With the two arrows on the left you can move from the previos tab (left) or
											the next tab (right).
										</p>
										<!-- Figure 1 -->
										<center>
											<span class="image responsive"><img src="images/Node-RED/home.png" alt="" /></span>
											<p style="text-align:center;">Home Tab</p>
										</center>
										
										<!-- Devices -->
										<h4>Devices</h4>
										<p>
											Here you can visualize all the devices that you have configured previously.
											In this case, our modules use the same sensors, so if you click on one of them,
											you have multiple buttons to change the visualization of the chart and gauge,
											for example by default we set the temperature, so you have the chart and gauge 
											of the temperature, but if you change you choice, these two will update with the
											new choice.<br>
											Under of them there's the chart with all the parameters.<br>
											
											Remeber: to add/remove device you need to modify the flow from the control panel.
										</p>
										<center>
											<iframe src="images/Node-RED/device-tab.gif" width="480" height="256" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
											<p style="text-align:center;">Devices Tab</p>
										</center>
										
										<!-- Charts -->
										<h4>Charts</h4>
										<p>
											In this tab you can visualize all the chart's parameters, 
											with the buttons you can visualize/hide them one by one.<br>
											
											Remeber: to add/remove parameters you need to modify the flow from the control panel.
										</p>
										<center>
											<iframe src="images/Node-RED/chart-tab.gif" width="480" height="270" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
											<p style="text-align:center;">Charts Tab</p>
										</center>
										
										<!-- RPi Control -->
										<h4>RPi Control</h4>
										<p>
											Here you can manage the gateway, visualize the main parameters,
											and reboot or shutdown it remotly.<br>
										</p>
										<center>
											<iframe src="images/Node-RED/rpi.gif" width="480" height="256" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
											<p style="text-align:center;">RPi Control Tab</p>
										</center>
										
										<!-- Files -->
										<h4>Files</h4>
										<p>
											Here you can visualize and manage all the log files that your modules creates on RPi,
											for example you can download the log files on your desktop or you can delete them.
											From another tab (Graph) with a drop down list you can visualize the file on the charts,
											as you can see on this example.
										</p>
										<!-- AGGIUNGI UNA GIF -->
										<center>
											<iframe src="images/Node-RED/file.gif" width="480" height="270" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
											<p style="text-align:center;">Files Tab</p>
										</center>
										</section>
									
										<h3>Reference to used Node-RED flows</h3>
										<ul class="links">
											<li><a href="https://flows.nodered.org/node/node-red-contrib-lorawan-packet-decrypt-nwkey-appkey">LoRaWAN Packet Decryptor</a></li>
											<li><a href="https://flows.nodered.org/flow/44bc7ad491aacb4253dd8a5f757b5407">File Browser in Dashboard</a></li>
											<li><a href="https://flows.nodered.org/flow/fa6e4749ff7f9067fd6b5330bc54f9e3">Raspberry System Monitoring</a></li>
										</ul>
									
									</article>
								</div>
							</div>
						<!-- </div> -->
					
				</section>

			<!-- Footer -->
				<div id="footer">
					<div class="container">
						<div class="row">
							<section class="col-6 col-12-narrower">
								<h2>Links to Stuff</h2>
								<ul class="links">
									<li><a href="https://www.uniud.it/it">University of Udine</a></li>
									<li><a href="http://www.diegm.uniud.it/bernardini/Laboratorio_Didattico/">Didactic Laboratory of Information Engineering</a></li>
									<li><a href="https://lora-alliance.org/">LoRa alliance</a></li>
									<li><a href="https://www.st.com/content/st_com/en.html">ST site</a></li>
								</ul>
							</section>
							<section class="col-6 col-12-narrower">
								<h2>Contacts</h2>
								<a href="https://github.com/lorenzozaccomer/smart-agriculture" class="icon brands fa-github"> GitHub Repository<span class="label">GitHub</span></a>
								<br>
								<br>
								<h4>Email</h4>
									<a href="mailto:zaccomer.lorenzo@spes.uniud.it" class="fas fa-at"> zaccomer.lorenzo@spes.uniud.it</a> <br/>
									<a href="mailto:shyti.klaid@spes.uniud.it" class="fas fa-at"> shyti.klaid@spes.uniud.it</a> <br/>
									<a href="mailto:dibetta.ivan@spes.uniud.it" class="fas fa-at"> dibetta.ivan@spes.uniud.it</a>
							</section>
						</div>
					</div>

					<!-- Icons -->

					<!-- Copyright -->
						<div class="copyright">
							<ul class="menu">
								<li>&copy; 2021 University of Udine<br>Polytechnic Department of Engineering and Architechture<br>Didactic Laboratory of Information Engineering</li>
								<li>&nbsp <br>Design: <a href="http://html5up.net">HTML5 UP</a><br> &nbsp</li>
							</ul>
						</div>

				</div>

		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script>
			// When the user scrolls the page, execute myFunction
			window.onscroll = function() {myFunction()};

			// Get the navbar
			var navbar = document.getElementById("nav");
			
			var serviceWrapper = document.getElementById("page-wrapper")

			// Get the offset position of the navbar
			var sticky = navbar.offsetTop;

			// Add the sticky class to the navbar when you reach its scroll position. Remove "sticky" when you leave the scroll position
			function myFunction() {
			  if (window.pageYOffset >= sticky) {
				navbar.classList.add("sticky");
				serviceWrapper.classList.add("service-stick-mode");
			  } else {
				navbar.classList.remove("sticky");
				serviceWrapper.classList.remove("service-stick-mode");
			  }
			}
			</script>
			<script>
			var slideIndex = 1;
			showSlides(slideIndex);

			// Next/previous controls
			function plusSlides(n) {
			  showSlides(slideIndex += n);
			}

			// Thumbnail image controls
			function currentSlide(n) {
			  showSlides(slideIndex = n);
			}

			function showSlides(n) {
			  var i;
			  var slides = document.getElementsByClassName("mySlides");
			  var dots = document.getElementsByClassName("dot");
			  if (n > slides.length) {slideIndex = 1}
			  if (n < 1) {slideIndex = slides.length}
			  for (i = 0; i < slides.length; i++) {
				  slides[i].style.display = "none";
			  }
			  for (i = 0; i < dots.length; i++) {
				  dots[i].className = dots[i].className.replace(" active", "");
			  }
			  slides[slideIndex-1].style.display = "block";
			  dots[slideIndex-1].className += " active";
			}
			</script>

	</body>
</html>
